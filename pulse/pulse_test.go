package pulse

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestPrepareCompressedPulse(t *testing.T) {
	bla := "255 2904 1388 771 11346 0 0 0 0100020002020000020002020000020002000202000200020002000200000202000200020000020002000200020002020002000002000200000002000200020002020002000200020034"

	result := prepareCompressedPulses(bla)

	assert.Equal(t, []int{255, 771, 1388, 2904, 11346}, result.pulseLengths)
	assert.Equal(t, "0300020002020000020002020000020002000202000200020002000200000202000200020000020002000200020002020002000002000200000002000200020002020002000200020014", result.pulses)
}

func TestFixPulses(t *testing.T) {
	bla := "255 2904 1388 771 11346 0 0 0 0100020002020000020002020000020002000202000200020002000200000202000200020000020002000200020002020002000002000200000002000200020002020002000200020034"

	result := prepareCompressedPulses(bla)

	result2 := fixPulses(result.pulseLengths, result.pulses)

	assert.Equal(t, []int{255, 1079, 2904, 11346}, result2.pulseLengths)
	assert.Equal(t, "0200010001010000010001010000010001000101000100010001000100000101000100010000010001000100010001010001000001000100000001000100010001010001000100010013", result2.pulses)
}
